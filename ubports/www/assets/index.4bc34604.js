(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const h of o.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&i(h)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerpolicy&&(o.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?o.credentials="include":s.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();function d(){}function $(e){return e()}function O(){return Object.create(null)}function y(e){e.forEach($)}function H(e){return typeof e=="function"}function M(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function W(e){return Object.keys(e).length===0}function B(e,t){e.appendChild(t)}function v(e,t,n){e.insertBefore(t,n||null)}function R(e){e.parentNode.removeChild(e)}function p(e){return document.createElement(e)}function C(e){return document.createTextNode(e)}function T(){return C(" ")}function U(e,t,n,i){return e.addEventListener(t,n,i),()=>e.removeEventListener(t,n,i)}function m(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function D(e){return Array.from(e.childNodes)}let _;function g(e){_=e}function S(){if(!_)throw new Error("Function called outside component initialization");return _}function j(e){S().$$.on_mount.push(e)}const f=[],x=[],b=[],G=[],q=Promise.resolve();let E=!1;function X(){E||(E=!0,q.then(P))}function N(e){b.push(e)}const L=new Set;let w=0;function P(){const e=_;do{for(;w<f.length;){const t=f[w];w++,g(t),Y(t.$$)}for(g(null),f.length=0,w=0;x.length;)x.pop()();for(let t=0;t<b.length;t+=1){const n=b[t];L.has(n)||(L.add(n),n())}b.length=0}while(f.length);for(;G.length;)G.pop()();E=!1,L.clear(),g(e)}function Y(e){if(e.fragment!==null){e.update(),y(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(N)}}const K=new Set;function J(e,t){e&&e.i&&(K.delete(e),e.i(t))}function Q(e,t,n,i){const{fragment:s,on_mount:o,on_destroy:h,after_update:l}=e.$$;s&&s.m(t,n),i||N(()=>{const a=o.map($).filter(H);h?h.push(...a):y(a),e.$$.on_mount=[]}),l.forEach(N)}function V(e,t){const n=e.$$;n.fragment!==null&&(y(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function Z(e,t){e.$$.dirty[0]===-1&&(f.push(e),X(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function ee(e,t,n,i,s,o,h,l=[-1]){const a=_;g(e);const r=e.$$={fragment:null,ctx:null,props:o,update:d,not_equal:s,bound:O(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(a?a.$$.context:[])),callbacks:O(),dirty:l,skip_bound:!1,root:t.target||a.$$.root};h&&h(r.root);let u=!1;if(r.ctx=n?n(e,t.props||{},(c,k,...I)=>{const A=I.length?I[0]:k;return r.ctx&&s(r.ctx[c],r.ctx[c]=A)&&(!r.skip_bound&&r.bound[c]&&r.bound[c](A),u&&Z(e,c)),k}):[],r.update(),u=!0,y(r.before_update),r.fragment=i?i(r.ctx):!1,t.target){if(t.hydrate){const c=D(t.target);r.fragment&&r.fragment.l(c),c.forEach(R)}else r.fragment&&r.fragment.c();t.intro&&J(e.$$.fragment),Q(e,t.target,t.anchor,t.customElement),P()}g(a)}class te{$destroy(){V(this,1),this.$destroy=d}$on(t,n){const i=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return i.push(n),()=>{const s=i.indexOf(n);s!==-1&&i.splice(s,1)}}$set(t){this.$$set&&!W(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const z=function(){const e={ROLLEN_ROUND:1,ROLLEN_GRIP:2,RIEMEN_ROUND:3,RIEMEN_GRIP:4,rbLength:1700,rbWidth:150,rbMaxCount:173,trockerLength1:150,trocknerAusgangLength:160,glRiemenCount:4};return e.assets=[{name:"rbAluBlockLeft",width:20,height:10,src:"assets/rb/engine/halterung/alu-block-left-20x10.png"},{name:"rbAluBlockRight",width:20,height:10,src:"assets/rb/engine/halterung/alu-block-right-20x10.png"},{name:"rolleLeft",width:6*6,height:296,src:"assets/RolleLeft_6x296.png"},{name:"rolleRight",width:6*6,height:296,src:"assets/RolleRight_6x296.png"},{name:"rbRiemen270x5",width:270,height:5*3,src:"assets/rb/engine/riemen/270x5.png"},{name:"rbRiemen290x5",width:290,height:5*3,src:"assets/rb/engine/riemen/290x5.png"},{name:"rbRiemen310x5",width:310,height:5*3,src:"assets/rb/engine/riemen/310x5.png"},{name:"rbRiemen430x5",width:430,height:5*3,src:"assets/rb/engine/riemen/430x5.png"},{name:"rbRiemen510x5",width:510,height:5*3,src:"assets/rb/engine/riemen/510x5.png"}],e.rb=[{name:"Trockner Eingang",engine:{count:15,type:e.ROLLEN_GRIP,side:"left"}},{name:"Ausrichter Eingang",engine:{count:14,type:e.ROLLEN_GRIP,side:"right"}},{name:"Rollen Bahn 5",engine:{count:14,type:e.ROLLEN_GRIP,side:"left"}},{name:"Rollen Bahn 4",engine:{count:22,type:e.ROLLEN_GRIP,side:"right"}},{name:"Rollen Bahn 3",engine:{count:22,type:e.ROLLEN_GRIP,side:"left"}},{name:"Rollen Bahn 2",engine:{count:22,type:e.ROLLEN_GRIP,side:"right"}},{name:"Rollen Bahn 1",engine:{count:22,type:e.ROLLEN_GRIP,side:"left"}},{name:"Wender",engine:{count:26,type:e.ROLLEN_GRIP,side:"right"}},{name:"Pressen \xDCbergangs Tisch",engine:{count:16,type:e.ROLLEN_GRIP,side:"right"}}],e.ta=[{name:"Gestell Rollen1",engine:{count:13,type:e.ROLLEN_GRIP}},{name:"Gestell Rollen 2",engine:{count:9,type:e.ROLLEN_GRIP}}],e.trockerAusgangRiemen={name:"Gestell Riemen",engine:{count:6,type:e.RIEMEN_ROUND}},e.pressenTisch={name:"Proben Tisch",engine:{count:6,type:e.RIEMEN_GRIP}},e}();class ne{constructor(t,n,i,s,o,h,l,a){this.name=t,this.assets=a,this.side=n,this.count=i,this.x=s,this.y=o,this.width=h,this.height=l,this._frameNumber}drawRiemen(t,n){const i=this.assets[`rbRiemen${this.count*20-10}x5`];if(i)t.drawImage(i,0,5*(this._frameNumber%3),i.width,i.height/3,this.x+n,this.side==="left"?this.y+11:this.y+(this.assets.rolleLeft.height+(10-4-5)),i.width,5);else throw`missing assets: "rbRiemen${this.count*10}x5"`}drawAluBlockLeft(t,n){let i=this.assets.rbAluBlockLeft;t.drawImage(i,this.x+n,this.y,i.width,i.height)}drawAluBlockRight(t,n){let i=this.assets.rbAluBlockRight;t.drawImage(i,this.x+n,this.y+(this.assets.rbAluBlockLeft.height+(this.assets.rolleLeft.height-4)),i.width,i.height)}drawRolle(t,n){let i;this.side==="left"?i=this.assets.rolleLeft:i=this.assets.rolleRight;let s=6*this._frameNumber,o=0,h=6,l=i.height,a=this.y+8,r=i.width/6,u=i.height;t.drawImage(i,s,o,h,l,this.x+n,a,r,u)}draw(t,n){let i=this._frameNumber||0;this._frameNumber=n;try{this.drawRiemen(t,5)}catch{this._frameNumber=i}let s=-1;for(let o=0;o<this.count;o++){s+=1;let h=s*this.assets.rbAluBlockLeft.width;this.drawAluBlockLeft(t,h),this.drawAluBlockRight(t,h),this.drawRolle(t,h+7)}}}class se{constructor(t,n,i){this.canvas=t,this.ctx=n,this.updateHz(i),this._lastFrame=0-this._fps,this._engineFrame=-1,this.assets={},this.engines,this.touchmove=!1,this.ontouchstart=null,this._touchstart=()=>{this.touchmove=!0},this.ontouchmove=null,this._touchmove=()=>{this.touchmove},this.ontouchend=null,this._touchend=()=>{this.touchmove=!1},this.ontouchcancel=null,this._touchcancel=s=>{!this.touchmove||this._touchend&&this._touchend(s)},this.mousemove=!1,this.onmousedown=null,this._mousedown=()=>{this.mousemove=!0},this.onmousemove=null,this._mousemove=()=>{this.mousemove},this.onmouseup=null,this._mouseup=()=>{this.mousemove=!1},this.onmouseover=null,this._mouseover=null,this.onmouseout=null,this._mouseout=s=>{!this.mousemove||this._mouseup&&this._mouseup(s)}}initialize(){this.canvas.width=window.innerWidth-2,this.canvas.height=window.innerHeight-4,window.onresize=()=>{this.canvas.width=window.innerWidth-2,this.canvas.height=window.innerHeight-4,this.initialize()},this.engines=[];let t=0;for(let n of z.rb){let i=t,s=this.canvas.height/2-312/2,o=n.engine.count*this.assets.rbAluBlockLeft.width,h=this.canvas.height;t+=o,this.engines.push(new ne(n.name,n.engine.side,n.engine.count,i,s,o,h,this.assets))}}handleUserInput(){this.canvas.ontouchstart=this._touchstart,this.canvas.ontouchmove=this._touchmove,this.canvas.ontouchend=this._touchend,this.canvas.ontouchcancel=this._touchcancel,this.canvas.onmousedown=this._mousedown,this.canvas.onmousemove=this._mousemove,this.canvas.onmouseup=this._mouseup,this.canvas.onmouseover=this._mouseover,this.canvas.onmouseout=this._mouseout}updateHz(t){this._fps=600/t}draw(t){if(t-this._lastFrame>=this._fps){this._engineFrame+=1,this._lastFrame=t,this._engineFrame>5&&(this._engineFrame=0);for(let n of this.engines)n.draw(this.ctx,this._engineFrame)}}async start(){this.initialize(),this.handleUserInput();const t=n=>{this.draw(n),requestAnimationFrame(t)};t(0)}}function ie(e){let t,n,i,s,o,h,l;return{c(){t=p("div"),n=p("input"),i=T(),s=p("main"),o=p("canvas"),m(n,"class","hz-rb svelte-125gzn2"),m(n,"type","number"),m(n,"min",0),m(n,"max",25),n.value=F,m(t,"class","overlay svelte-125gzn2"),m(o,"class","svelte-125gzn2"),m(s,"class","svelte-125gzn2")},m(a,r){v(a,t,r),B(t,n),v(a,i,r),v(a,s,r),B(s,o),e[3](o),h||(l=U(n,"change",e[2]),h=!0)},p:d,i:d,o:d,d(a){a&&R(t),a&&R(i),a&&R(s),e[3](null),h=!1,l()}}}let F=12;function oe(e,t,n){let i,s;j(()=>{const l=i.getContext("2d");n(1,s=new se(i,l,F));const a=new Set;for(let r of z.assets)n(1,s.assets[r.name]=new Image(r.width,r.height),s),location.protocol!=="file:"&&(a.add(s.assets[r.name].src),n(1,s.assets[r.name].onloadend=u=>{a.delete(u.target.src),a.size||s.initialize()},s)),console.log("[DEBUG] load image:",r.src),n(1,s.assets[r.name].src=r.src,s),n(1,s.assets[r.name].onerror=u=>{console.warn("[WARNING] load game asset failed:",u.target.src)},s);s.start()});const o=l=>s.updateHz(parseInt(l.currentTarget.value));function h(l){x[l?"unshift":"push"](()=>{i=l,n(0,i)})}return[i,s,o,h]}class re extends te{constructor(t){super(),ee(this,t,oe,ie,M,{})}}new re({target:document.getElementById("app")});
