(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerpolicy&&(r.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?r.credentials="include":i.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(i){if(i.ep)return;i.ep=!0;const r=n(i);fetch(i.href,r)}})();function g(){}function P(e){return e()}function A(){return Object.create(null)}function y(e){e.forEach(P)}function D(e){return typeof e=="function"}function z(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function j(e){return Object.keys(e).length===0}function O(e,t){e.appendChild(t)}function v(e,t,n){e.insertBefore(t,n||null)}function b(e){e.parentNode.removeChild(e)}function _(e){return document.createElement(e)}function H(e){return document.createTextNode(e)}function M(){return H(" ")}function W(e,t,n,s){return e.addEventListener(t,n,s),()=>e.removeEventListener(t,n,s)}function d(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function X(e){return Array.from(e.childNodes)}let p;function m(e){p=e}function C(){if(!p)throw new Error("Function called outside component initialization");return p}function T(e){C().$$.on_mount.push(e)}const f=[],L=[],R=[],$=[],S=Promise.resolve();let E=!1;function V(){E||(E=!0,S.then(F))}function N(e){R.push(e)}const x=new Set;let w=0;function F(){const e=p;do{for(;w<f.length;){const t=f[w];w++,m(t),q(t.$$)}for(m(null),f.length=0,w=0;L.length;)L.pop()();for(let t=0;t<R.length;t+=1){const n=R[t];x.has(n)||(x.add(n),n())}R.length=0}while(f.length);for(;$.length;)$.pop()();E=!1,x.clear(),m(e)}function q(e){if(e.fragment!==null){e.update(),y(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(N)}}const Y=new Set;function K(e,t){e&&e.i&&(Y.delete(e),e.i(t))}function J(e,t,n,s){const{fragment:i,on_mount:r,on_destroy:a,after_update:l}=e.$$;i&&i.m(t,n),s||N(()=>{const h=r.map(P).filter(D);a?a.push(...h):y(h),e.$$.on_mount=[]}),l.forEach(N)}function Q(e,t){const n=e.$$;n.fragment!==null&&(y(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function Z(e,t){e.$$.dirty[0]===-1&&(f.push(e),V(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function ee(e,t,n,s,i,r,a,l=[-1]){const h=p;m(e);const o=e.$$={fragment:null,ctx:null,props:r,update:g,not_equal:i,bound:A(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(h?h.$$.context:[])),callbacks:A(),dirty:l,skip_bound:!1,root:t.target||h.$$.root};a&&a(o.root);let c=!1;if(o.ctx=n?n(e,t.props||{},(u,I,...B)=>{const G=B.length?B[0]:I;return o.ctx&&i(o.ctx[u],o.ctx[u]=G)&&(!o.skip_bound&&o.bound[u]&&o.bound[u](G),c&&Z(e,u)),I}):[],o.update(),c=!0,y(o.before_update),o.fragment=s?s(o.ctx):!1,t.target){if(t.hydrate){const u=X(t.target);o.fragment&&o.fragment.l(u),u.forEach(b)}else o.fragment&&o.fragment.c();t.intro&&K(e.$$.fragment),J(e,t.target,t.anchor,t.customElement),F()}m(h)}class te{$destroy(){Q(this,1),this.$destroy=g}$on(t,n){const s=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return s.push(n),()=>{const i=s.indexOf(n);i!==-1&&s.splice(i,1)}}$set(t){this.$$set&&!j(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const k=function(){const e={ROLLEN_ROUND:1,ROLLEN_GRIP:2,RIEMEN_ROUND:3,RIEMEN_GRIP:4,rbLength:1700,rbWidth:150,rbMaxCount:173,trockerLength1:150,trocknerAusgangLength:160,glRiemenCount:4};return e.assets=[{name:"rbAluBlockLeft",width:20,height:10,src:"assets/rb/engine/halterung/alu-block-left-20x10.png"},{name:"rbAluBlockRight",width:20,height:10,src:"assets/rb/engine/halterung/alu-block-right-20x10.png"},{name:"rolleLeft",width:6*6,height:296,src:"assets/RolleLeft_6x296.png"},{name:"rolleRight",width:6*6,height:296,src:"assets/RolleRight_6x296.png"},{name:"rbRiemen270x5",width:270,height:5*3,src:"assets/rb/engine/riemen/270x5.png"},{name:"rbRiemen290x5",width:290,height:5*3,src:"assets/rb/engine/riemen/290x5.png"},{name:"rbRiemen310x5",width:310,height:5*3,src:"assets/rb/engine/riemen/310x5.png"},{name:"rbRiemen430x5",width:430,height:5*3,src:"assets/rb/engine/riemen/430x5.png"},{name:"rbRiemen510x5",width:510,height:5*3,src:"assets/rb/engine/riemen/510x5.png"}],e.rb=[{name:"Trockner Eingang",engine:{count:15,type:e.ROLLEN_GRIP,side:"left"}},{name:"Ausrichter Eingang",engine:{count:14,type:e.ROLLEN_GRIP,side:"right"}},{name:"Rollen Bahn 5",engine:{count:14,type:e.ROLLEN_GRIP,side:"left"}},{name:"Rollen Bahn 4",engine:{count:22,type:e.ROLLEN_GRIP,side:"right"}},{name:"Rollen Bahn 3",engine:{count:22,type:e.ROLLEN_GRIP,side:"left"}},{name:"Rollen Bahn 2",engine:{count:22,type:e.ROLLEN_GRIP,side:"right"}},{name:"Rollen Bahn 1",engine:{count:22,type:e.ROLLEN_GRIP,side:"left"}},{name:"Wender",engine:{count:26,type:e.ROLLEN_GRIP,side:"right"}},{name:"Pressen \xDCbergangs Tisch",engine:{count:16,type:e.ROLLEN_GRIP,side:"right"}}],e.ta=[{name:"Gestell Rollen1",engine:{count:13,type:e.ROLLEN_GRIP}},{name:"Gestell Rollen 2",engine:{count:9,type:e.ROLLEN_GRIP}}],e.trockerAusgangRiemen={name:"Gestell Riemen",engine:{count:6,type:e.RIEMEN_ROUND}},e.pressenTisch={name:"Proben Tisch",engine:{count:6,type:e.RIEMEN_GRIP}},e}();class ne{constructor(t,n,s,i,r,a,l,h){this.name=t,this.assets=h,this.side=n,this.count=s,this.x=i,this.y=r,this.width=a,this.height=l,this._frameNumber}drawRiemen(t,n){const s=this.assets[`rbRiemen${this.count*20-10}x5`];if(s)t.drawImage(s,0,5*(this._frameNumber%3),s.width,s.height/3,this.x+n,this.side==="left"?this.y+11:this.y+(this.assets.rolleLeft.height+(10-4-5)),s.width,5);else throw`missing assets: "rbRiemen${this.count*10}x5"`}drawAluBlockLeft(t,n){let s=this.assets.rbAluBlockLeft;t.drawImage(s,this.x+n,this.y,s.width,s.height)}drawAluBlockRight(t,n){let s=this.assets.rbAluBlockRight;t.drawImage(s,this.x+n,this.y+(this.assets.rbAluBlockLeft.height+(this.assets.rolleLeft.height-4)),s.width,s.height)}drawRolle(t,n){let s;this.side==="left"?s=this.assets.rolleLeft:s=this.assets.rolleRight;let i=6*this._frameNumber,r=0,a=6,l=s.height,h=this.y+8,o=s.width/6,c=s.height;t.drawImage(s,i,r,a,l,this.x+n,h,o,c)}draw(t,n){let s=this._frameNumber||0;this._frameNumber=n;try{this.drawRiemen(t,5)}catch{this._frameNumber=s}let i=-1;for(let r=0;r<this.count;r++){i+=1;let a=i*this.assets.rbAluBlockLeft.width;this.drawAluBlockLeft(t,a),this.drawAluBlockRight(t,a),this.drawRolle(t,a+7)}}}class ie{constructor(t,n,s){this.canvas=t,this.ctx=n,this.updateHz(s),this._lastFrame=0-this._fps,this._engineFrame=-1,this.assets={},this.engines=[],this.pointer=!1,this.onpointerdown=null,this._pointerdown=i=>{console.log("[DEBUG] pointerdown"),this.view.sX=i.x,this.pointer=!0},this.onpointermove=null,this._pointermove=i=>{!this.pointer||(console.log("[DEBUG] pointermove"),this.view.x-=this.view.sX-i.x,this.view.y=this.canvas.height/2-312/2,this.view.sX=i.x,this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.moveView(this.view))},this.onpointerup=null,this._pointerup=()=>{!this.pointer||(this.pointer=!1,console.log("[DEBUG] pointerup"))},this.onpointercancel=null,this._pointercancel=i=>{!this.pointer||(console.log("[DEBUG] pointercancel"),this._pointerup&&this._pointerup(i))},this.onpointerout=null,this._pointerout=i=>{!this.pointer||(console.log("[DEBUG] pointerout"),this._pointerup&&this._pointerup(i))},this.canvas.width=window.innerWidth-2,this.canvas.height=window.innerHeight-4,window.onresize=()=>{this.canvas.width=window.innerWidth-2,this.canvas.height=window.innerHeight-4,this.view.y=this.canvas.height/2-312/2,this.moveView(this.view)},this.view={sX:0,x:0,y:this.canvas.height/2-312/2}}createEngine(t,n,s){let i=t.engine.count*this.assets.rbAluBlockLeft.width,r=this.canvas.height;return new ne(t.name,t.engine.side,t.engine.count,n,s,i,r,this.assets)}updateEngine(t,n,s){return t.x=n,t.y=s,t.height=this.canvas.height,t}moveView(t){let n=t.x;for(let s=0;s<k.rb.length;s++){let i=this.engines[s];i?i=this.updateEngine(i,n,t.y):(i=this.createEngine(k.rb[s],n,t.y),this.engines.push(i)),n+=i.width}}handleUserInput(){this.canvas.onpointerdown=this._pointerdown,this.canvas.onpointermove=this._pointermove,this.canvas.onpointerup=this._pointerup,this.canvas.onpointercancel=this._pointercancel,this.canvas.onpointerout=this._pointerout}updateHz(t){this._fps=600/t}draw(t){if(t-this._lastFrame>=this._fps){this._engineFrame+=1,this._lastFrame=t,this._engineFrame>5&&(this._engineFrame=0);for(let n of this.engines)n.draw(this.ctx,this._engineFrame)}}drawBackground(){}async start(){this.moveView(this.view),this.handleUserInput();const t=n=>{this.draw(n),requestAnimationFrame(t)};t(0)}}function se(e){let t,n,s,i,r,a,l;return{c(){t=_("div"),n=_("input"),s=M(),i=_("main"),r=_("canvas"),d(n,"class","hz-rb svelte-tijnbm"),d(n,"type","number"),d(n,"min",0),d(n,"max",25),n.value=U,d(t,"class","overlay svelte-tijnbm"),d(r,"class","svelte-tijnbm"),d(i,"class","svelte-tijnbm")},m(h,o){v(h,t,o),O(t,n),v(h,s,o),v(h,i,o),O(i,r),e[3](r),a||(l=W(n,"change",e[2]),a=!0)},p:g,i:g,o:g,d(h){h&&b(t),h&&b(s),h&&b(i),e[3](null),a=!1,l()}}}let U=12;function re(e,t,n){let s,i;T(()=>{const l=s.getContext("2d");n(1,i=new ie(s,l,U));const h=new Set;for(let o of k.assets)n(1,i.assets[o.name]=new Image(o.width,o.height),i),location.protocol!=="file:"&&(h.add(i.assets[o.name].src),n(1,i.assets[o.name].onloadend=c=>{h.delete(c.target.src),h.size||i.initialize()},i)),console.log("[DEBUG] load image:",o.src),n(1,i.assets[o.name].src=o.src,i),n(1,i.assets[o.name].onerror=c=>{console.warn("[WARNING] load game asset failed:",c.target.src)},i);i.start()});const r=l=>i.updateHz(parseInt(l.currentTarget.value));function a(l){L[l?"unshift":"push"](()=>{s=l,n(0,s)})}return[s,i,r,a]}class oe extends te{constructor(t){super(),ee(this,t,re,se,z,{})}}new oe({target:document.getElementById("app")});
